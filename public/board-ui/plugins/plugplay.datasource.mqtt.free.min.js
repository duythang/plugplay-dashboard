!function(){freeboard.loadDatasourcePlugin({type_name:"paho_mqtt",display_name:"Free MQTT",description:"Send/Receive data to/from a MQTT server.",external_scripts:["https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js"],settings:[{name:"server",display_name:"MQTT Server",type:"text",description:"Hostname for your MQTT Server",required:!0},{name:"port",display_name:"Port",type:"number",description:"The port to connect to the MQTT Server on",required:!0},{name:"use_ssl",display_name:"Use SSL",type:"boolean",description:"Use SSL/TLS to connect to the MQTT Server",default_value:!0},{name:"client_id",display_name:"Client Id",type:"text",default_value:"",required:!1},{name:"username",display_name:"Username",type:"text",default_value:"",required:!1},{name:"password",display_name:"Password",type:"text",default_value:"",required:!1},{name:"topic",display_name:"Topic",type:"text",description:"The topic to subscribe and publish",required:!0},{name:"json_data",display_name:"JSON messages?",type:"boolean",description:"If the messages on your topic are in JSON format they will be parsed so the individual fields can be used in freeboard widgets",default_value:!1}],newInstance:function(n,t,s){t(new e(n,s))}});var e=function(e,n){function t(){console.log("Connected"),d.subscribe(r.topic)}function s(e){0!==e.errorCode&&console.log("onConnectionLost:"+e.errorMessage)}function o(e){i.topic=e.destinationName,i.msg=r.json_data?JSON.parse(e.payloadString):e.payloadString,n(i)}var a=this,i={},r=e;a.send=function(e){if(d.isConnected()){switch(typeof e){case"boolean":e=e?"1":"0";break;case"number":e=String(e);break;case"object":e=JSON.stringify(e);break;case"string":}var n=new Paho.MQTT.Message(e);n.destinationName=r.topic,d.send(n)}},a.onSettingsChanged=function(e){i={},r=e,d.isConnected()&&d.disconnect(),d=new Paho.MQTT.Client(r.server,r.port,r.client_id),d.onConnectionLost=s,d.onMessageArrived=o,d.connect({onSuccess:t,userName:r.username,password:r.password,useSSL:r.use_ssl}),a.updateNow()},a.updateNow=function(){},a.onDispose=function(){d.isConnected()&&d.disconnect(),d={}};var d=new Paho.MQTT.Client(r.server,r.port,r.client_id);d.onConnectionLost=s,d.onMessageArrived=o,d.connect({onSuccess:t,userName:r.username,password:r.password,useSSL:r.use_ssl})}}();