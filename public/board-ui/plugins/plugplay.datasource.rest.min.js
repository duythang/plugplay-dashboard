!function(){freeboard.loadDatasourcePlugin({type_name:"plugplay_restful",display_name:"PlugPlay REST",description:"Receive data from an REST server.",settings:[{name:"user_key",display_name:"User Key",type:"text",required:!0},{name:"board_id",display_name:"Board Id",type:"text",required:!0},{name:"topic",display_name:"Topic",type:"text",description:"The topic to send or receive data",required:!0},{name:"recv_data",display_name:"Receive data",type:"boolean",description:"If you use this function, the Datasource will load data periodically with a interval",default_value:!1},{name:"interval",display_name:"Refresh Every",suffix:"seconds",type:"number",description:"The value has to be bigger than 2 (seconds)",default_value:5}],newInstance:function(a,t,n){t(new e(a,n))}});var e=function(e,a){function t(e){4==n.readyState&&200==n.status?e&&(r.msg=JSON.parse(n.responseText),a(r)):4==n.readyState&&200!=n.status&&console.log("Connect REST Failed : "+n.status)}var n,s,i,o=this,r={},d=e;s="/api/rest/"+d.user_key+"&"+d.board_id+"&"+d.topic,o.send=function(e){if(n){switch(typeof e){case"boolean":e=e?"1":"0";break;case"number":e=String(e);break;case"object":e=JSON.stringify(e);break;case"string":}n.onreadystatechange=t(!1),n.open("PUT",s,!0),n.setRequestHeader("Content-Type","application/json"),n.send(e)}},o.onSettingsChanged=function(e){r={},d=e,s="/api/rest/"+d.user_key+"&"+d.board_id+"&"+d.topic,clearInterval(i),d.recv_data&&(i=setInterval(function(){n.onreadystatechange=t(!0),n.open("GET",s,!0),n.setRequestHeader("Content-Type","application/json"),n.send()},1e3*d.interval)),o.updateNow()},o.updateNow=function(){r.msg={device:"",data0:"",data1:"",data2:""},a(r)},o.onDispose=function(){clearInterval(i)},n=new XMLHttpRequest,d.recv_data&&(d.interval<2&&(d.interval=2),i=setInterval(function(){n.onreadystatechange=t(!0),n.open("GET",s,!0),n.setRequestHeader("Content-Type","application/json"),n.send()},1e3*d.interval))}}();