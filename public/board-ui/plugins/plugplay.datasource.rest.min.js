!function(){freeboard.loadDatasourcePlugin({type_name:"plugplay_restful",display_name:"PlugPlay REST",description:"Send/Receive data to/from the PlugPlay REST server.",settings:[{name:"user_key",display_name:"User Key",type:"text",required:!0},{name:"board_id",display_name:"Board Id",type:"text",required:!0},{name:"topic",display_name:"Topic",type:"text",description:"The topic to send and receive data",required:!0},{name:"recv_data",display_name:"Receive data",type:"boolean",default_value:!1},{name:"refresh",display_name:"Refresh Every",suffix:"seconds",type:"number",description:"The value has to be bigger than 2 (seconds)",default_value:3}],newInstance:function(t,a,n){a(new e(t,n))}});var e=function(e,t){function a(e){4==u.readyState&&200==u.status?(console.log("PlugPlay REST connected"),e&&(c.msg=JSON.parse(u.responseText),t(c))):4==u.readyState&&200!=u.status&&console.log("PlugPlay REST connected error : "+u.status)}function n(){u.onreadystatechange=a(!0),u.open("GET",r,!0),u.setRequestHeader("Content-Type","application/json"),u.send()}function s(){i&&(clearTimeout(i),i=null)}function o(){s(),p.recv_data&&(r="/api/rest/"+p.user_key+"&"+p.board_id+"&"+p.topic,p.refresh<2&&(p.refresh=2),i=setInterval(n,1e3*p.refresh))}var r,i,d=this,c={},u=new XMLHttpRequest,p=e;d.send=function(e){if(u){switch(typeof e){case"boolean":e=e?"1":"0";break;case"number":e=String(e);break;case"object":e=JSON.stringify(e);break;case"string":}u.onreadystatechange=a(!1),u.open("PUT",r,!0),u.setRequestHeader("Content-Type","application/json"),u.send(e)}},d.onSettingsChanged=function(e){c={},p=e,o(),d.updateNow()},d.updateNow=function(){c.msg={device:"",data0:"",data1:"",data2:""},t(c)},d.onDispose=function(){s()},o()}}();